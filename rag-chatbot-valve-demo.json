{
  "name": "RAG Ingestion - Valve Handbook",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        1296,
        544
      ],
      "id": "e4c4a4e9-ed84-4921-aef3-2e6b30e79067",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1PIxi-f9QMAMwUlkaAIDM80dz6J1ka2tA",
          "mode": "list",
          "cachedResultName": "Valve_Handbook_LowRes.pdf",
          "cachedResultUrl": "https://drive.google.com/file/d/1PIxi-f9QMAMwUlkaAIDM80dz6J1ka2tA/view?usp=drivesdk"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1720,
        544
      ],
      "id": "cfee8e0b-1638-4703-9b4e-0036c2c9402c",
      "name": "Download file",
      "credentials": {}
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        2144,
        544
      ],
      "id": "44e97c03-2088-4696-b745-695a507adc0f",
      "name": "Supabase Vector Store",
      "credentials": {}
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1856,
        368
      ],
      "id": "793e1365-c94c-46a4-87d9-51e7e22cebac",
      "name": "Embeddings OpenAI",
      "credentials": {}
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        2216,
        768
      ],
      "id": "ad085a40-e435-4523-9f5d-a62d551ec48d",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "You are a helpful assistant answering questions ONLY based on the Valve Employee Handbook.\n\nUse the provided tools to retrieve relevant context from the handbook.\n\nInstructions:\n- Answer questions using ONLY information from retrieved documents.\n- If the retrieved context does not contain relevant information, or if no documents are returned, respond exactly: \"This information is not in the Valve Employee Handbook.\"\n- Do not speculate, guess, or use external knowledge.\n- If relevant, cite the source (e.g., \"According to page X...\").\n- Keep answers concise and direct."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        1576,
        -64
      ],
      "id": "1a1a239f-1014-4b67-9909-fbbe99126af0",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        1296,
        144
      ],
      "id": "ae7a3413-517f-4add-8ff2-28d6eb7faa4a",
      "name": "When chat message received",
      "webhookId": "07cc4235-a8cd-475d-89f7-0887c3cb3b25"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1520,
        160
      ],
      "id": "9ba40544-99e7-4d58-8867-447e5306c08a",
      "name": "OpenAI Chat Model",
      "credentials": {}
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "retrieve documents from vector store",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        1776,
        160
      ],
      "id": "f1e88838-2e7b-426f-b38c-4a8baf4c7caf",
      "name": "Supabase Vector Store1",
      "credentials": {}
    },
    {
      "parameters": {
        "contextWindowLength": 8
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        1648,
        160
      ],
      "id": "709eb72d-5556-4be7-8136-69d1e553116b",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "content": "# Valve Handbook RAG Chatbot Demo\n* Accurate, cited answers from company documents\n* No hallucinations \n* Multi-turn conversation\n* Customizable for any knowledge",
        "width": 624
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1504,
        -336
      ],
      "typeVersion": 1,
      "id": "f809c720-1f65-4308-af94-8c0a29d635da",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Memory + Retrieval\n* Simple Memory (window buffer)\n* Semantic search for relevant chunks\n* Strict grounding only from handbook",
        "height": 176,
        "width": 272,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1440,
        336
      ],
      "typeVersion": 1,
      "id": "496f98f5-9623-4574-89ef-7edfcc16cfe5",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Document Ingestion\n* Load & extract PDF text\n*  Chunk (1000 chars + overlap)\n* Embed with OpenAI\n* Store in Supabase vector DB\nRun once to index handbook",
        "width": 272,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1536,
        752
      ],
      "typeVersion": 1,
      "id": "bea6fc22-fc52-4fb6-a3a8-15b61dfa32dd",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## AI Agent\n* GPT-4o-mini\n* Strict prompt: No external knowledge\n* If no info → \"Not in handbook\"\n* Supports follow-ups",
        "height": 144,
        "width": 320,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1952,
        -96
      ],
      "typeVersion": 1,
      "id": "b2bb98ed-104d-4b8a-b83d-5d18d29a6e1e",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Response Delivery\n* Sends answer to user\n* Ready for Telegram/Slack/webhook\n* Easy to customize",
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1008,
        144
      ],
      "typeVersion": 1,
      "id": "584689bb-4b76-486f-a21c-7aae63c06fa9",
      "name": "Sticky Note4"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "Supabase Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Supabase Vector Store1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "d51b35f6-9bf9-4e06-85ec-a707d9dd7a30",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "aec370bde44fa13acd9e9690b41b9cf941a12d67707ebff60e454c301b92c4aa"
  },
  "id": "PjEAB7gKjbNf32mj",
  "tags": []
}